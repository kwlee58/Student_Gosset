---
title: "Student 3000 Criminal Data"
author: "coop711"
date: "2015년 3월 19일"
output: html_document
---

Structure of Data
-----------------

- W. S. Gosset 이 t-분포를 유도하느라고 모의실험에 활용한 자료는 다음과 같음.

```{r}
crimtab
str(crimtab)
```

- 이 자료를 long format 으로 전환하는 과정은 다음과 같음. as.data.frame() 에서 stringsAsFactors=FALSE가 매우 중요한 역할을 하는 것임. 이 옵션을 설정하지 않을 경우 Factor로 잡히면 numeric으로 전환할 수 없게 됨. Factor는 본질적으로 음이 아닌 정수로 취급됨.

```{r}
crimtab.2<-crimtab
crimtab.2.df<-as.data.frame(crimtab.2, stringsAsFactors = F)
crimtab.2.df$finger<-as.numeric(crimtab.2.df$Var1)
crimtab.2.df$height<-as.numeric(crimtab.2.df$Var2)
str(crimtab.2.df)
crimtab.df<-crimtab.2.df[,3:5]
str(crimtab.df)
crimtab.long<-apply(crimtab.df[,2:3],2, function(x)rep(x, crimtab.df[,1]))
str(crimtab.long)
plot(finger~height, data=crimtab.long)
str(crimtab.long)
```
- 변수 각각의 히스토그램은?

```{r fig.width=8, fig.height=4}
par(mfrow=c(1,2))
hist(crimtab.long[,2], main="Histogram of Height", xlab="height(cm)")
hist(crimtab.long[,1], main="Histogram of Finger Length", xlab= "finger length(cm)")
```

- 평균과 표준편차를 구하면 다음과 같음. 이를 모수로 하는 정규곡선을 덧씌워 볼 것.

```{r}
apply(crimtab.long, 2, mean)
apply(crimtab.long, 2, sd)
```

- Quetelet의 가슴둘레 자료에서 살핀 바와 같이 이 자료를 그대로 ad.test 등에 적용하면 매우 작은 p-value 가 예상됨.

```{r}
library(nortest)
ad.test(crimtab.long[,1])
ad.test(crimtab.long[,2])
```

- height의 경우 인치 단위로 측정한 자료를 센티 단위로 변환한 것임. 이 점에 유의하여 원 자료의 모습에 가깝게 noise 를 넣어 적용하면

```{r}
r.noise<-runif(3000)-0.5
hist(r.noise, prob=T, xlim=c(-0.5,0.5), ylim=c(0,1.5))
ad.test(crimtab.long[,2]+r.noise*2.54)
cvm.test(crimtab.long[,2]+r.noise*2.54)
lillie.test(crimtab.long[,2]+r.noise*2.54)
ad.test(crimtab.long[,1]+r.noise/10)
cvm.test(crimtab.long[,1]+r.noise/10)
lillie.test(crimtab.long[,1]+r.noise/10)
```

```{r, save}
save.image("./crimtab_0319.rda")
```